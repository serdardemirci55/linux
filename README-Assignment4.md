CMPE283 : Virtualization

Assignment 4: Nested Paging vs. Shadow Paging

Questions:

	1. Did the assignment by myself.

	2. Include a sample of your print of exit count output from dmesg from “with ept” and “without ept”.

		With ep:

			Total exit count:
			
			0x4fffffff 0x00: eax=0x0008c9ed ebx=0xffffbb4b ecx=0x00000000 edx=0xffff93f4

			Total exit count for each type of exit:

			0x4ffffffd 0x00: eax=0x00000009 ebx=0xffffbb4b ecx=0x00000000 edx=0xffff93f4
			0x4ffffffd 0x01: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000001 edx=0xffff93f4
			0x4ffffffd 0x02: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000002 edx=0xffff93f4
			0x4ffffffd 0x03: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x04: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x05: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x06: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x07: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000007 edx=0xffff93f4
			0x4ffffffd 0x08: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000008 edx=0xffff93f4
			0x4ffffffd 0x09: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000009 edx=0xffff93f4
			0x4ffffffd 0x0a: eax=0x0002b3cd ebx=0xffffbb4b ecx=0x0000000a edx=0xffff93f4
			0x4ffffffd 0x0b: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x0c: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000c edx=0xffff93f4
			0x4ffffffd 0x0d: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000d edx=0xffff93f4
			0x4ffffffd 0x0e: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000e edx=0xffff93f4
			0x4ffffffd 0x0f: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000f edx=0xffff93f4
			0x4ffffffd 0x10: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x11: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x12: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000012 edx=0xffff93f4
			0x4ffffffd 0x13: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000013 edx=0xffff93f4
			0x4ffffffd 0x14: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000014 edx=0xffff93f4
			0x4ffffffd 0x15: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000015 edx=0xffff93f4
			0x4ffffffd 0x16: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000016 edx=0xffff93f4
			0x4ffffffd 0x17: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000017 edx=0xffff93f4
			0x4ffffffd 0x18: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000018 edx=0xffff93f4
			0x4ffffffd 0x19: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000019 edx=0xffff93f4
			0x4ffffffd 0x1a: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000001a edx=0xffff93f4
			0x4ffffffd 0x1b: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000001b edx=0xffff93f4
			0x4ffffffd 0x1c: eax=0x00020d4a ebx=0xffffbb4b ecx=0x0000001c edx=0xffff93f4
			0x4ffffffd 0x1d: eax=0x00000001 ebx=0xffffbb4b ecx=0x0000001d edx=0xffff93f4
			0x4ffffffd 0x1e: eax=0x00043ccc ebx=0xffffbb4b ecx=0x0000001e edx=0xffff93f4
			0x4ffffffd 0x1f: eax=0x00000108 ebx=0xffffbb4b ecx=0x0000001f edx=0xffff93f4
			0x4ffffffd 0x20: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000020 edx=0xffff93f4
			0x4ffffffd 0x21: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x22: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x23: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x24: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000024 edx=0xffff93f4
			0x4ffffffd 0x25: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000025 edx=0xffff93f4
			0x4ffffffd 0x26: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x27: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000027 edx=0xffff93f4
			0x4ffffffd 0x28: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000028 edx=0xffff93f4
			0x4ffffffd 0x29: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000029 edx=0xffff93f4
			0x4ffffffd 0x2a: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x2b: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002b edx=0xffff93f4
			0x4ffffffd 0x2c: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002c edx=0xffff93f4
			0x4ffffffd 0x2d: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002d edx=0xffff93f4
			0x4ffffffd 0x2e: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002e edx=0xffff93f4
			0x4ffffffd 0x2f: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002f edx=0xffff93f4
			0x4ffffffd 0x30: eax=0x00000678 ebx=0xffffbb4b ecx=0x00000030 edx=0xffff93f4
			0x4ffffffd 0x31: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000031 edx=0xffff93f4
			0x4ffffffd 0x32: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000032 edx=0xffff93f4
			0x4ffffffd 0x33: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x34: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000034 edx=0xffff93f4
			0x4ffffffd 0x35: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000035 edx=0xffff93f4
			0x4ffffffd 0x36: eax=0x00000006 ebx=0xffffbb4b ecx=0x00000036 edx=0xffff93f4
			0x4ffffffd 0x37: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000037 edx=0xffff93f4
			0x4ffffffd 0x38: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000038 edx=0xffff93f4
			0x4ffffffd 0x39: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000039 edx=0xffff93f4
			0x4ffffffd 0x3a: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003a edx=0xffff93f4
			0x4ffffffd 0x3b: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003b edx=0xffff93f4
			0x4ffffffd 0x3c: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003c edx=0xffff93f4
			0x4ffffffd 0x3d: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003d edx=0xffff93f4
			0x4ffffffd 0x3e: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003e edx=0xffff93f4
			0x4ffffffd 0x3f: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x40: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x41: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x42: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x43: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x44: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x45: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x46: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff

		Without ept:

			Total exit count:
			
			0x4fffffff 0x00: eax=0x00573fec ebx=0xffffbb4b ecx=0x00000000 edx=0xffff93f4

			Total exit count for each type of exit:

			0x4ffffffd 0x00: eax=0x0013d44e ebx=0xffffbb4b ecx=0x00000000 edx=0xffff93f4
			0x4ffffffd 0x01: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000001 edx=0xffff93f4
			0x4ffffffd 0x02: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000002 edx=0xffff93f4
			0x4ffffffd 0x03: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x04: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x05: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x06: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x07: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000007 edx=0xffff93f4
			0x4ffffffd 0x08: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000008 edx=0xffff93f4
			0x4ffffffd 0x09: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000009 edx=0xffff93f4
			0x4ffffffd 0x0a: eax=0x00040cfc ebx=0xffffbb4b ecx=0x0000000a edx=0xffff93f4
			0x4ffffffd 0x0b: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x0c: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000c edx=0xffff93f4
			0x4ffffffd 0x0d: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000d edx=0xffff93f4
			0x4ffffffd 0x0e: eax=0x0001b8c9 ebx=0xffffbb4b ecx=0x0000000e edx=0xffff93f4
			0x4ffffffd 0x0f: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000000f edx=0xffff93f4
			0x4ffffffd 0x10: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x11: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x12: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000012 edx=0xffff93f4
			0x4ffffffd 0x13: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000013 edx=0xffff93f4
			0x4ffffffd 0x14: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000014 edx=0xffff93f4
			0x4ffffffd 0x15: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000015 edx=0xffff93f4
			0x4ffffffd 0x16: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000016 edx=0xffff93f4
			0x4ffffffd 0x17: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000017 edx=0xffff93f4
			0x4ffffffd 0x18: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000018 edx=0xffff93f4
			0x4ffffffd 0x19: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000019 edx=0xffff93f4
			0x4ffffffd 0x1a: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000001a edx=0xffff93f4
			0x4ffffffd 0x1b: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000001b edx=0xffff93f4
			0x4ffffffd 0x1c: eax=0x003a9feb ebx=0xffffbb4b ecx=0x0000001c edx=0xffff93f4
			0x4ffffffd 0x1d: eax=0x00000002 ebx=0xffffbb4b ecx=0x0000001d edx=0xffff93f4
			0x4ffffffd 0x1e: eax=0x00075aac ebx=0xffffbb4b ecx=0x0000001e edx=0xffff93f4
			0x4ffffffd 0x1f: eax=0x00000230 ebx=0xffffbb4b ecx=0x0000001f edx=0xffff93f4
			0x4ffffffd 0x20: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000020 edx=0xffff93f4
			0x4ffffffd 0x21: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x22: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x23: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x24: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000024 edx=0xffff93f4
			0x4ffffffd 0x25: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000025 edx=0xffff93f4
			0x4ffffffd 0x26: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x27: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000027 edx=0xffff93f4
			0x4ffffffd 0x28: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000028 edx=0xffff93f4
			0x4ffffffd 0x29: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000029 edx=0xffff93f4
			0x4ffffffd 0x2a: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x2b: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002b edx=0xffff93f4
			0x4ffffffd 0x2c: eax=0x0000000d ebx=0xffffbb4b ecx=0x0000002c edx=0xffff93f4
			0x4ffffffd 0x2d: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002d edx=0xffff93f4
			0x4ffffffd 0x2e: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002e edx=0xffff93f4
			0x4ffffffd 0x2f: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000002f edx=0xffff93f4
			0x4ffffffd 0x30: eax=0x0000068a ebx=0xffffbb4b ecx=0x00000030 edx=0xffff93f4
			0x4ffffffd 0x31: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000031 edx=0xffff93f4
			0x4ffffffd 0x32: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000032 edx=0xffff93f4
			0x4ffffffd 0x33: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x34: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000034 edx=0xffff93f4
			0x4ffffffd 0x35: eax=0x00000000 ebx=0x00000000 ecx=0x00000035 edx=0x00000000
			0x4ffffffd 0x36: eax=0x0000000e ebx=0xffffbb4b ecx=0x00000036 edx=0xffff93f4
			0x4ffffffd 0x37: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000037 edx=0xffff93f4
			0x4ffffffd 0x38: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000038 edx=0xffff93f4
			0x4ffffffd 0x39: eax=0x00000000 ebx=0xffffbb4b ecx=0x00000039 edx=0xffff93f4
			0x4ffffffd 0x3a: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003a edx=0xffff93f4
			0x4ffffffd 0x3b: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003b edx=0xffff93f4
			0x4ffffffd 0x3c: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003c edx=0xffff93f4
			0x4ffffffd 0x3d: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003d edx=0xffff93f4
			0x4ffffffd 0x3e: eax=0x00000000 ebx=0xffffbb4b ecx=0x0000003e edx=0xffff93f4
			0x4ffffffd 0x3f: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x40: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x41: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff
			0x4ffffffd 0x42: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x43: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x44: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x45: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0x00000000
			0x4ffffffd 0x46: eax=0x00000000 ebx=0x00000000 ecx=0x00000000 edx=0xffffffff

	3. What did you learn from the count of exits? Was the count what you expected? If not, why not?

		When I look at the count of exits, I saw that "Exception or non-maskable interrupt (NMI)" and
    "Control-register accesses" exit reasons have been occurring really really much (a few million)
    more when the shadow paging was used. Besides, INVLPG and "APIC access" exit reasons have occurred
    when the shadow paging was used which have never occurred when the nested paging was used.

		The count was not what I am expected. In shadow paging, total exit counts increased dramatically
    which occurred ten times more in total than nested paging. I didn't expect it to increase so much.
    But, this is because the shadow paging is using the #PF and Control register manipulations by design. 
    So, that exits have been occurring much in the shadow paging.

	4. What changed between the two runs (ept vs no-ept)?

		Boot using ept is incredibly faster than using no-ept. When ept disabled, It took really too much to boot the VM. 
